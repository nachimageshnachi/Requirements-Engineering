@startuml
skinparam monochrome true
skinparam packageStyle rectangle
skinparam activity {
  BackgroundColor White
  BorderColor Black
}

|Passengers|
start
:Request ticket;

|SOI – WT System|
:Provide ticket;

|Passengers|
:Travel to station;

|SOI – WT System|
:Arrive at station;
:Secure train;
:Announce stop;

fork
  |Passengers|
  :Present ticket;

  |SOI – WT System|
  :Validate ticket;

  if (Ticket valid?) then (yes)
    |Passengers|
    :Access platform;
    
    |SOI – WT System|
    repeat
      :Disembark passengers;
    repeat while (Passengers remaining?) is (yes)
    ->no;

    repeat
      :Embark passengers;
    repeat while (Boarding complete?) is (no)
    ->yes;

    :Send Passenger Ready;
  else (no)
    |Passengers|
    :Access denied;
    stop
  endif

fork again
  |Cargo Handling|
  repeat
    :Unload freight;
  repeat while (Unloading complete?) is (no)
  ->yes;

  repeat
    :Load freight;
  repeat while (Loading complete?) is (no)
  ->yes;

  :Send Cargo Ready;

fork again
  |Catering|
  :Restock supplies;
  :Remove waste;
  :Send Catering Ready;

fork again
  |Cleaning|
  :Clean interior;
  :Confirm cabin readiness;
  :Send Cleaning Ready;
end fork

|SOI – WT System|
repeat
  :Evaluate departure readiness;
  if (All services ready?) then (yes)
    break
  else (no)
    :Hold at station;
  endif
repeat while (Waiting...)

:Obtain departure clearance;
:Announce departure;
:Initiate departure;
:Leave station area;
stop
@enduml